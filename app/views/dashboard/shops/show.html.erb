<div class="block-shop-header clearfix">
  <div class="shop-cover media-margin-shop-top">
    <h2 class="row_h2">
      <%= @shop.name %>
    </h2>
    <%= image_tag @shop.cover_image.url, class: "defaut-pic-cover" %>
    <div class="shop-info-wrapper">
      <div class="shop-avatar-wrapper row">
        <div class="col-sm-3 col-xs-3 show-shop-avatar">
          <%= image_tag @shop.avatar.url, class: "avatar igm245 img_cover_size",
            id: "img-avatar" %>
          <%= simple_form_for [:dashboard, @shop], html: {id: "form_id"} do |f| %>
            <div class="container">
              <div class="row">
                <div class="col-sm-4">
                  <% if @domain.present? %>
                    <%= f.hidden_field :domain_id, value: @domain.id %>
                  <% end %>
                  <%= f.file_field :avatar, onchange: "this.form.submit();",
                    class: "glyphicon glyphicon-camera wh change-picture" %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
    <div class="col-xs-12 col-md-12 shop-nav-wrapper">
      <div class="row">
        <div class="col-md-offset-3 col-md-5 col-xs-offset-3 col-xs-5">
          <div class="row shop-basic-info margin_top_shop">
            <h4 class="title">
              <%= @shop.name %>
              <%= render "shared/shop_status_label", shop: @shop %>
            </h4>
            <h4>
              <%= link_to t("dashboard.order.view_order_list"),
                dashboard_shop_orders_path(@shop.id),
                class: "btn btn-theme width_btn" %>
              <%= link_to t("dashboard.order.view_history_orders"),
                dashboard_shop_order_managers_path(@shop.id),
                class: "btn btn-theme" %>
            </h4>
          </div>
        </div>
        <div class="col-md-4 col-xs-5">
          <div class="panel panel-info shop_user">
            <div class="panel-heading">
              <%= t "common.shop_managers" %>
            </div>
            <div class="shop_user-own">
              <% @users_shop_manager.each do |user| %>
                <%= link_to user_path(user), class: "user-item-image" do %>
                  <%= image_tag user.avatar.url, alt: user.name,
                    title: user.name %>
                <% end %>
              <% end %>
              <% if @shop.owner_id == current_user.id %>
                <%= link_to "#manager_of_shop", "data-toggle": "modal",
                  class: "user-item-image" do %>
                  <%= image_tag "add_circle.png", alt: t("set_manager_shop") %>
                <% end %>
              <% end %>
            </div>
            <% if @shop.owner_id == current_user.id %>
              <div class="panel-footer">
                <%= link_to t("change_shop_owner"), "#",
                  class: "btn btn-default btn-block",
                  data: {toggle: "modal", target: "#shop-manager-modal"} %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="margin-for-shopinfo">
    <table class="table table-striped table-inverse padding-102">
      <tr>
        <td class="for-td">
          <strong><%= t "shop_name" %></strong><%= @shop.name %>
        </td>
        <td class="for-td">
          <strong><%= t "time_auto_reject" %></strong>
          <%= l @shop.time_auto_reject, format: :short_time %>
          <%= t "minutes" %>
        </td>
        <td class="for-td">
          <strong><%= t "number_product" %></strong><%= @shop.products.size %>
        </td>
        <td class="for-td">
          <%= link_to t(".edit"), edit_dashboard_shop_path(@shop),
            class: "btn btn-success pull-right margin_right_10px" %>
        </td>
      </tr>
    </table>
  </div>
</div>
<div class="block-shop-header clearfix">
  <div>
  <h2 class="section_title margin_right_15px row_h2">
    <div class="btn_view_all_wrapper pull-right">
      <%= link_to t("common.create_button"),
        new_dashboard_shop_product_path(@shop),
        class: "btn btn_view_all btn-warning" %>
    </div>
    <% if @products.any? %>
      <%= t ".has_products" %>
    <% else %>
      <%= t ".no_product" %>
    <% end %>
  </h2>
  </div>
  <div class="box_pro">
    <%= render "products" if @products.any? %>
  </div>
</div>

<div id="shop-manager-modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header modal_header">
        <button type="button" class="close" data-dismiss="modal"
          aria-hidden="true">&times;</button>
        <h4 class="modal-title modal_text_header"><%= t "change_shop_owner" %></h4>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-10 col-md-offset-1">
            <%= form_tag shop_path(@shop), method: :put do %>
              <%= render "shared/error_messages", object: @shop %>
              <div class="form-group">
                <h4 class="center"><%= label_tag(:email, t("enter_email")) %></h4>
              </div>
              <div class="form-group">
                <%= email_field_tag :email, nil, class: "form-control"%>
              </div>
              <div class="center padding-top-10">
                <%= submit_tag t("edit_user.update"),
                  class: "btn btn-default space-top-submit" %>
                <button type="button" class="list btn btn-default"
                  data-dismiss="modal"><%= t "cancel" %>
                </button>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="manager_of_shop">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header modal_header">
        <button type="button" class="close" data-dismiss="modal"
          aria-hidden="true">&times;</button>
        <h4 class="modal-title modal_text_header"><%= t "set_manage_for_shop" %></h4>
      </div>
      <div class="modal-body h500">
        <div class="row">
          <div class="row">
            <div class="search_users col-md-10 col-md-offset-1">
              <%= form_tag new_search_path, method: :get, id: "search_owner_form",
                remote: true do %>
                <%= hidden_field_tag :shop_id, @support.shop_manager.shop_id %>
                <div class="form-group">
                  <%= text_field_tag :search, params[:search],
                    placeholder: t("dashboard.order.btn_search") << "...",
                    class: "form-control" %>
                </div>
              <% end %>
            </div>
          </div>
          <div class="">
            <div class="panel panel-success">
              <div class="add-user-table">
                <table class="table table-striped table-hover table-bordered">
                  <thead class="">
                    <tr>
                      <th></th>
                      <th class="td-user-name-table"><%= t "admin.users.index.name" %></th>
                      <th class="td-user-action-table"><%= t "admin.users.index.actions" %></th>
                    </tr>
                  </thead>
                  <tbody id="list_users">
                    <%= render "dashboard/shop_managers/users" %>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">
          <%= t "order_statistics.done" %>
        </button>
      </div>
    </div>
  </div>
</div>
